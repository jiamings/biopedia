{% extends "include/navbar-fixed-top.html" %}
{% block navbar %}
    <ul class="nav navbar-nav">
                <li><a href="/index">Home</a></li>
                <li class="active"><a href="/{{ language }}/projects">Projects</a></li>
    </ul>
    {% include "include/nav_bar_right.html" %}
{% endblock %}
{% block contain %}
<div class="jumbotron">
    <div class="container">
        <h1>Projects</h1>

        <p>All the projects are listed here.</p>

        <p><a class="btn btn-primary btn-lg">Learn more</a></p>
    </div>
</div>

<div class="container">
    <table id="projects" class="table table-striped table-bordered">
        <thead>
        <tr>
            <th>Projects</th>
            <th>Environment</th>
            <th>Site</th>
            <th>Sequence Type</th>
            <th>Project Id</th>
            <th># of Total Sequences</th>
            <th># of ORFs</th>
            <th># of Samples</th>
            <th>Read Length</th>
            <th>Platform</th>
            <th>Create Date</th>
            <th>Update Data</th>
            {% if user %}
            <th>Star</th>
            {% endif %}
        </tr>
        </thead>
        <tbody>
        {% for project in project_list %}
            <tr>
                <td><a href="/samples?name={{ project['name'] }}">{{ project['name'] }}</a></td>
                <td>{{ project['environment'] }}</td>
                <td>{{ project['site'] }}</td>
                <td>{{ project['sequence_type'] }}</td>
                <td>{{ project['project_id'] }}</td>
                <td>{{ project['num_of_total_sequences'] }}</td>
                <td>{{ project['num_of_orfs'] }}</td>
                <td>{{ project['num_of_samples'] }}</td>
                <td>{{ project['read_length'] }}</td>
                <td>{{ project['platform'] }}</td>
                <td>{{ project['create_date']['month'] }}/{{ project['create_date']['day'] }}/{{ project['create_date']['year'] }}
                </td>
                <td>{{ project['update_date']['month'] }}/{{ project['update_date']['day'] }}/{{ project['update_date']['year'] }}
                </td>
                {% if user %}
                <td>
                {% if project['star'] %}
                    <img id="{{ project['name'] }}" class="circle" height="50px" width="50px"
                         onclick="toggleStarStatus('{{ user['username'] }}', '{{ project['name'] }}')"
                         src="/unstar-picture" alt="icon">
                {% else %}
                    <img id="{{ project['name'] }}" class="circle" height="50px" width="50px"
                         onclick="toggleStarStatus('{{ user['username'] }}', '{{ project['name'] }}')"
                         src="/star-picture" alt="icon">
                {% endif %}
                </td>
                {% endif %}
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
{% block title %}
        Biopedia - Projects
{% endblock %}
{% block picture %}
    {% if not username %}
        {% include "include/login_register_modals.html" %}
    {% endif %}
{%endblock%}
{% block scripts %}
 <script type="text/javascript">
 function toggleStarStatus(username, project) {
     $.ajax({url:"/star?user=" + username + "&project=" + project},
        async=false)
     .done(function( html ){
        if (html == "Star") {
            $("#" + project).attr('src', '/star-picture');
        } else if (html == "Unstar"){
            $("#" + project).attr('src', '/unstar-picture');
        } else {
            alert("Session failed. Please reload your page.")
        };

     })
 }

    $(document).ready(function () {
        $('#projects').dataTable().columnFilter();
    });
</script>
{% endblock %}

